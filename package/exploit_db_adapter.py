from dotenv import load_dotenv
from pyExploitDb import PyExploitDb
import os

class ExploitDBAdapter:   

    def __init__(self,  pe_db=""): 
        if pe_db == "":
            self.pe_db = PyExploitDb()
            self.pe_db.debug = False
        else:
            self.pe_db = pe_db
            
    def search_cve(self, keyword):
        self.pe_db.openFile()
        results = self.pe_db.searchCve(keyword)
        return results 

    def is_org(self, host):
      if not host:
        return False

      org_data = self.get_org_data(host)
      if org_data['Country Code'] != 'TW':
        return False

      if org_data['ASN'] != '4782':
        return False
        
      return True

if __name__ == '__main__':
    pe_db = ExploitDBAdapter()
    keyword = "CVE-2018-14592"

    print(pe_db.search_cve(keyword))
